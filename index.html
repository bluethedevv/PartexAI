<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PartexAI - AI App Builder</title>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        :root {
            --primary: #7C3AED;
            --primary-dark: #6D28D9;
            --primary-light: #8B5CF6;
            --secondary: #10B981;
            --secondary-dark: #0D946E;
            --secondary-light: #34D399;
            --background: #0F0F0F;
            --background-light: #1A1A1A;
            --background-lighter: #262626;
            --surface: #1A1A1A;
            --surface-light: #262626;
            --surface-lighter: #374151;
            --text-primary: #FFFFFF;
            --text-secondary: #A1A1AA;
            --text-tertiary: #71717A;
            --border: #374151;
            --border-light: #4B5563;
            --border-lighter: #6B7280;
            --success: #10B981;
            --success-dark: #0D946E;
            --warning: #F59E0B;
            --warning-dark: #D97706;
            --error: #EF4444;
            --error-dark: #DC2626;
            --info: #3B82F6;
            --credits: #F59E0B;
            --credits-dark: #D97706;
            --gradient-primary: linear-gradient(135deg, var(--primary), var(--secondary));
            --gradient-secondary: linear-gradient(135deg, var(--primary-light), var(--secondary-light));
            --gradient-surface: linear-gradient(135deg, var(--surface), var(--surface-light));
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            --radius-3xl: 2rem;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            background: var(--background);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            font-weight: 400;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Auth Screens */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--gradient-surface);
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            animation: backgroundShift 10s ease-in-out infinite;
        }

        .auth-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-2xl);
            padding: 3rem;
            width: 100%;
            max-width: 28rem;
            box-shadow: var(--shadow-2xl);
            position: relative;
            z-index: 10;
            backdrop-filter: blur(20px);
            animation: cardEntrance 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .auth-logo {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .auth-logo h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -0.025em;
        }

        .auth-logo p {
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 500;
        }

        .auth-input-group {
            margin-bottom: 1.5rem;
        }

        .auth-label {
            display: block;
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            transition: var(--transition);
        }

        .auth-input {
            width: 100%;
            background: var(--surface-light);
            border: 1.5px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1rem 1.25rem;
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 400;
            transition: var(--transition);
            outline: none;
        }

        .auth-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
            background: var(--surface-lighter);
        }

        .auth-input::placeholder {
            color: var(--text-tertiary);
        }

        .auth-btn {
            width: 100%;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            padding: 1rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .auth-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: var(--transition-slow);
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .auth-btn:hover::before {
            left: 100%;
        }

        .auth-btn:active {
            transform: translateY(0);
        }

        .auth-toggle {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .auth-toggle a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .auth-toggle a:hover {
            color: var(--primary-light);
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--error);
            color: var(--error);
            padding: 1rem 1.25rem;
            border-radius: var(--radius-lg);
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            display: none;
            animation: shake 0.5s ease-in-out;
        }

        /* Main App */
        .app-container {
            display: none;
            min-height: 100vh;
            background: var(--background);
            position: relative;
        }

        .app-container::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 15% 50%, rgba(124, 58, 237, 0.03) 0%, transparent 50%),
                        radial-gradient(circle at 85% 30%, rgba(16, 185, 129, 0.03) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* Header */
        .header {
            background: rgba(26, 26, 26, 0.8);
            border-bottom: 1px solid var(--border);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.75rem;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.025em;
        }

        .nav-links {
            display: flex;
            gap: 2.5rem;
            align-items: center;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            transition: var(--transition);
            position: relative;
            padding: 0.5rem 0;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--gradient-primary);
            transition: var(--transition);
            border-radius: 2px;
        }

        .nav-link:hover {
            color: var(--text-primary);
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .nav-link.active {
            color: var(--text-primary);
        }

        .nav-link.active::after {
            width: 100%;
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .credits-badge {
            background: var(--credits);
            color: #000;
            padding: 0.75rem 1.25rem;
            border-radius: 2rem;
            font-weight: 700;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .credits-badge:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--credits-dark);
        }

        .avatar {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-md);
            border: 2px solid transparent;
        }

        .avatar:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-light);
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 26rem;
            gap: 3rem;
            padding: 3rem 0;
            min-height: calc(100vh - 5rem);
            position: relative;
            z-index: 1;
        }

        /* Sections */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: slideUp 0.5s ease-out;
        }

        /* Dashboard Section */
        .dashboard-section {
            display: block;
        }

        /* Chat Section */
        .chat-section {
            background: var(--surface);
            border-radius: var(--radius-2xl);
            border: 1px solid var(--border);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: var(--shadow-xl);
            transition: var(--transition);
        }

        .chat-section:hover {
            box-shadow: var(--shadow-2xl);
        }

        .chat-header {
            padding: 2rem 2.5rem;
            border-bottom: 1px solid var(--border);
            background: var(--surface-light);
        }

        .chat-header h2 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .chat-header p {
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 400;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 2rem 2.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            max-height: 35rem;
            scroll-behavior: smooth;
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: var(--surface-light);
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--border-light);
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: var(--border-lighter);
        }

        .message {
            display: flex;
            gap: 1rem;
            animation: messageSlide 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 2.75rem;
            height: 2.75rem;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 700;
            flex-shrink: 0;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
        }

        .message.user .message-avatar {
            background: var(--gradient-secondary);
        }

        .message-avatar:hover {
            transform: scale(1.1);
        }

        .message-content {
            background: var(--surface-light);
            padding: 1.25rem 1.5rem;
            border-radius: var(--radius-xl);
            max-width: 75%;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
            animation: messagePop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            transition: var(--transition);
        }

        .message-content:hover {
            box-shadow: var(--shadow-md);
        }

        .message.user .message-content {
            background: var(--primary);
            color: white;
            border: none;
            box-shadow: var(--shadow-md);
        }

        .message.user .message-content:hover {
            box-shadow: var(--shadow-lg);
        }

        .message-text {
            line-height: 1.6;
            font-size: 0.95rem;
            font-weight: 400;
        }

        .message-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .action-btn {
            background: var(--surface);
            border: 1.5px solid var(--border);
            color: var(--text-primary);
            padding: 0.75rem 1.25rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-btn:hover {
            background: var(--surface-light);
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .action-btn.credits {
            background: var(--credits);
            color: #000;
            border: none;
            font-weight: 700;
        }

        .action-btn.credits:hover {
            background: var(--credits-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .action-btn.secondary {
            background: transparent;
            border-color: var(--secondary);
            color: var(--secondary);
        }

        .action-btn.secondary:hover {
            background: var(--secondary);
            color: white;
        }

        .chat-input-container {
            padding: 2rem 2.5rem;
            border-top: 1px solid var(--border);
            background: var(--surface-light);
        }

        .chat-input {
            display: flex;
            gap: 1rem;
            align-items: flex-end;
        }

        .input-field {
            flex: 1;
            background: var(--surface);
            border: 1.5px solid var(--border);
            border-radius: var(--radius-xl);
            padding: 1.25rem 1.5rem;
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 400;
            resize: none;
            min-height: 4rem;
            max-height: 8rem;
            transition: var(--transition);
            outline: none;
            line-height: 1.5;
        }

        .input-field:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
            background: var(--surface-lighter);
        }

        .input-field::placeholder {
            color: var(--text-tertiary);
        }

        .send-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: var(--radius-xl);
            padding: 1.25rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow-md);
        }

        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .send-btn:active {
            transform: translateY(0);
        }

        .send-btn:disabled {
            background: var(--border);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Custom Input Section */
        .custom-input-section {
            background: var(--surface-light);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin: 1.5rem 2.5rem;
            border: 1px solid var(--border);
            display: none;
            animation: slideDown 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .custom-input-section h4 {
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .custom-input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.25rem;
        }

        .custom-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .custom-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .custom-input {
            background: var(--surface);
            border: 1.5px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1rem 1.25rem;
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: var(--transition);
            outline: none;
        }

        .custom-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        .custom-select {
            background: var(--surface);
            border: 1.5px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1rem 1.25rem;
            color: var(--text-primary);
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition);
            outline: none;
        }

        .custom-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        .color-input-group {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .color-picker {
            width: 3.5rem;
            height: 3.5rem;
            border: none;
            border-radius: var(--radius-lg);
            cursor: pointer;
            background: var(--surface);
            border: 1.5px solid var(--border);
            transition: var(--transition);
        }

        .color-picker:hover {
            transform: scale(1.05);
        }

        .color-picker:focus {
            outline: 2px solid var(--primary);
        }

        .feature-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 1rem 0;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-light);
        }

        .feature-toggle:last-child {
            border-bottom: none;
        }

        .toggle-label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-weight: 500;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 3.5rem;
            height: 2rem;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border);
            transition: var(--transition);
            border-radius: 2rem;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 1.5rem;
            width: 1.5rem;
            left: 0.25rem;
            bottom: 0.25rem;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
            box-shadow: var(--shadow-sm);
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(1.5rem);
        }

        /* Projects Section */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .project-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            padding: 2rem;
            transition: var(--transition);
            cursor: pointer;
        }

        .project-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: var(--shadow-xl);
        }

        .project-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .project-card h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .project-card p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .project-stats {
            display: flex;
            justify-content: space-between;
            color: var(--text-tertiary);
            font-size: 0.875rem;
        }

        /* Documentation Section */
        .docs-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 3rem;
            margin-top: 2rem;
        }

        .docs-sidebar {
            background: var(--surface);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border);
            padding: 2rem;
            height: fit-content;
            position: sticky;
            top: 2rem;
        }

        .docs-nav {
            list-style: none;
        }

        .docs-nav li {
            margin-bottom: 0.5rem;
        }

        .docs-nav a {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 0.75rem 1rem;
            border-radius: var(--radius-lg);
            display: block;
            transition: var(--transition);
        }

        .docs-nav a:hover,
        .docs-nav a.active {
            background: var(--surface-light);
            color: var(--text-primary);
        }

        .docs-content {
            background: var(--surface);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border);
            padding: 3rem;
        }

        .docs-section {
            margin-bottom: 3rem;
        }

        .docs-section h2 {
            font-size: 1.75rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .docs-section p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .code-block {
            background: var(--background);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin: 1.5rem 0;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
        }

        /* Phone Preview */
        .phone-preview {
            background: var(--surface);
            border-radius: var(--radius-2xl);
            border: 1px solid var(--border);
            padding: 2.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: var(--shadow-xl);
            transition: var(--transition);
        }

        .phone-preview:hover {
            box-shadow: var(--shadow-2xl);
        }

        .phone-device {
            width: 20rem;
            height: 42rem;
            background: #1a1a1a;
            border-radius: 3rem;
            padding: 1.5rem;
            position: relative;
            border: 0.75rem solid #2a2a2a;
            box-shadow: var(--shadow-2xl);
            transition: var(--transition);
        }

        .phone-device:hover {
            transform: translateY(-5px);
        }

        .phone-screen {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 2rem;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
        }

        .app-preview {
            width: 100%;
            height: 100%;
            background: var(--surface);
            overflow-y: auto;
            position: relative;
        }

        .generated-app {
            width: 100%;
            height: 100%;
            background: white;
            color: #000;
            overflow-y: auto;
            font-family: 'Inter', sans-serif;
            transform-origin: top left;
            transition: var(--transition-slow);
        }

        .preview-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(135deg, #7C3AED, #10B981);
            color: white;
            padding: 3rem 2rem;
        }

        .preview-header h4 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .preview-header p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .preview-content {
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
        }

        .preview-item {
            background: var(--surface-light);
            padding: 1.5rem;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            transition: var(--transition);
            animation: itemSlide 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .preview-item:hover {
            transform: translateX(5px);
            box-shadow: var(--shadow-md);
        }

        .preview-placeholder {
            background: linear-gradient(90deg, var(--surface-light), var(--border), var(--surface-light));
            background-size: 200% 100%;
            animation: loading 2s ease-in-out infinite;
            height: 6rem;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
        }

        /* Progress Section */
        .progress-container {
            margin-top: 2.5rem;
            width: 100%;
            display: none;
            animation: slideUp 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.25rem;
        }

        .progress-header h4 {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
        }

        .progress-text {
            color: var(--primary);
            font-size: 1rem;
            font-weight: 700;
        }

        .progress-bar {
            height: 0.75rem;
            background: var(--surface-light);
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-primary);
            border-radius: 1rem;
            transition: var(--transition-slow);
            width: 0%;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        /* History Section */
        .history-section {
            background: var(--surface);
            border-radius: var(--radius-2xl);
            border: 1px solid var(--border);
            padding: 2.5rem;
            margin-top: 2rem;
            max-height: 25rem;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            transition: var(--transition);
        }

        .history-section:hover {
            box-shadow: var(--shadow-2xl);
        }

        .history-section::-webkit-scrollbar {
            width: 6px;
        }

        .history-section::-webkit-scrollbar-track {
            background: var(--surface-light);
            border-radius: 3px;
        }

        .history-section::-webkit-scrollbar-thumb {
            background: var(--border-light);
            border-radius: 3px;
        }

        .history-section::-webkit-scrollbar-thumb:hover {
            background: var(--border-lighter);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .history-header h3 {
            color: var(--text-primary);
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .history-item {
            background: var(--surface-light);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: var(--transition);
            animation: itemSlide 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .history-item:hover {
            border-color: var(--primary);
            transform: translateX(5px);
            box-shadow: var(--shadow-md);
        }

        .history-item h4 {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .history-item p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .history-date {
            color: var(--text-tertiary);
            font-size: 0.75rem;
            margin-top: 0.75rem;
        }

        /* Download Button */
        .download-btn {
            background: var(--success);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            padding: 1.25rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 1.5rem;
            width: 100%;
            display: none;
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .download-btn:hover {
            background: var(--success-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .download-btn:active {
            transform: translateY(0);
        }

        /* Scale Controls */
        .scale-controls {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
            width: 100%;
            display: none;
            animation: slideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .scale-btn {
            flex: 1;
            background: var(--surface-light);
            border: 1.5px solid var(--border);
            color: var(--text-primary);
            padding: 0.75rem 1rem;
            border-radius: var(--radius-lg);
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            transition: var(--transition);
            text-align: center;
        }

        .scale-btn:hover {
            background: var(--surface-lighter);
            border-color: var(--primary-light);
        }

        .scale-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: var(--shadow-md);
        }

        /* Animations */
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes messagePop {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes itemSlide {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes cardEntrance {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(50px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        @keyframes backgroundShift {
            0%, 100% {
                transform: translate(0, 0) scale(1);
            }
            50% {
                transform: translate(-10px, -10px) scale(1.02);
            }
        }

        @keyframes loading {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }

        @keyframes shimmer {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            10%, 30%, 50%, 70%, 90% {
                transform: translateX(-5px);
            }
            20%, 40%, 60%, 80% {
                transform: translateX(5px);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
            
            .phone-preview {
                display: none;
            }
            
            .container {
                padding: 0 1.5rem;
            }

            .docs-container {
                grid-template-columns: 1fr;
            }

            .docs-sidebar {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            
            .auth-card {
                padding: 2rem;
                margin: 1rem;
            }
            
            .chat-header,
            .chat-messages,
            .chat-input-container {
                padding: 1.5rem;
            }
            
            .custom-input-row {
                grid-template-columns: 1fr;
            }
            
            .phone-device {
                width: 18rem;
                height: 38rem;
            }

            .projects-grid {
                grid-template-columns: 1fr;
            }

            .docs-content {
                padding: 2rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 1rem;
            }
            
            .auth-card {
                padding: 1.5rem;
            }
            
            .chat-section {
                border-radius: var(--radius-xl);
            }
            
            .message-content {
                max-width: 85%;
            }
            
            .phone-device {
                width: 16rem;
                height: 34rem;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Auth Screens -->
    <div id="authContainer" class="auth-container">
        <div class="auth-card">
            <div class="auth-logo">
                <h1>PartexAI</h1>
                <p>AI App Builder Platform</p>
            </div>
            
            <!-- Login -->
            <div id="loginDiv">
                <div id="loginError" class="error-message"></div>
                <div class="auth-input-group">
                    <label class="auth-label" for="loginEmail">Email Address</label>
                    <input type="email" id="loginEmail" class="auth-input" placeholder="Enter your email" value="demo@partexai.com">
                </div>
                <div class="auth-input-group">
                    <label class="auth-label" for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="auth-input" placeholder="Enter your password" value="demopassword123">
                </div>
                <button class="auth-btn" onclick="login()">
                    <span>Sign In</span>
                </button>
                <div class="auth-toggle">
                    <p>Don't have an account? <a onclick="showRegister()">Create one here</a></p>
                </div>
            </div>

            <!-- Register -->
            <div id="registerDiv" style="display: none;">
                <div id="registerError" class="error-message"></div>
                <div class="auth-input-group">
                    <label class="auth-label" for="registerUsername">Username</label>
                    <input type="text" id="registerUsername" class="auth-input" placeholder="Choose a username">
                </div>
                <div class="auth-input-group">
                    <label class="auth-label" for="registerEmail">Email Address</label>
                    <input type="email" id="registerEmail" class="auth-input" placeholder="Enter your email">
                </div>
                <div class="auth-input-group">
                    <label class="auth-label" for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" class="auth-input" placeholder="Create a password">
                </div>
                <button class="auth-btn" onclick="register()">
                    <span>Create Account</span>
                </button>
                <div class="auth-toggle">
                    <p>Already have an account? <a onclick="showLogin()">Sign in here</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="appContainer" class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <nav class="nav">
                    <div class="logo">PartexAI</div>
                    <div class="nav-links">
                        <a href="#" class="nav-link active" onclick="showSection('dashboard')">Dashboard</a>
                        <a href="#" class="nav-link" onclick="showSection('projects')">Projects</a>
                        <a href="#" class="nav-link" onclick="showSection('templates')">Templates</a>
                        <a href="#" class="nav-link" onclick="showSection('documentation')">Documentation</a>
                        <a href="#" class="nav-link" onclick="showSection('support')">Support</a>
                    </div>
                    <div class="user-section">
                        <div class="credits-badge" id="creditsDisplay">
                            <span>‚ö°</span>
                            <span id="creditsCount">400</span> Credits
                        </div>
                        <div class="avatar" id="userAvatar" onclick="logout()">U</div>
                    </div>
                </nav>
            </div>
        </header>

        <!-- Main Content -->
        <div class="container">
            <!-- Dashboard Section -->
            <div id="dashboardSection" class="section dashboard-section active">
                <div class="main-content">
                    <!-- Chat Section -->
                    <section class="chat-section">
                        <div class="chat-header">
                            <h2>Ask PartexAI...</h2>
                            <p>Describe your app or ask anything - AI builds it step by step</p>
                        </div>

                        <div class="chat-messages" id="chatMessages">
                            <div class="message">
                                <div class="message-avatar">AI</div>
                                <div class="message-content">
                                    <p class="message-text">üëã Hello! I'm PartexAI. What kind of app would you like to create today?</p>
                                    <p class="message-text"><strong>‚ö° Cost: 40 Credits per app | 5 Credits for normal chat</strong></p>
                                    <div class="message-actions">
                                        <button class="action-btn credits" onclick="selectTemplate('social')">
                                            <span>üì±</span>
                                            <span>Social Media App</span>
                                        </button>
                                        <button class="action-btn credits" onclick="selectTemplate('recipe')">
                                            <span>üç≥</span>
                                            <span>Recipe App</span>
                                        </button>
                                        <button class="action-btn credits" onclick="selectTemplate('news')">
                                            <span>üì∞</span>
                                            <span>News Reader</span>
                                        </button>
                                        <button class="action-btn credits" onclick="selectTemplate('weather')">
                                            <span>üå§Ô∏è</span>
                                            <span>Weather App</span>
                                        </button>
                                        <button class="action-btn secondary" onclick="showCustomInput()">
                                            <span>‚öôÔ∏è</span>
                                            <span>Custom App</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Custom Input Section -->
                        <div class="custom-input-section" id="customInputSection">
                            <h4>üé® Customize Your App</h4>
                            <div class="custom-input-row">
                                <div class="custom-input-group">
                                    <label class="custom-label">App Name</label>
                                    <input type="text" id="appName" class="custom-input" placeholder="My Awesome App" value="My Awesome App">
                                </div>
                                <div class="custom-input-group">
                                    <label class="custom-label">App Type</label>
                                    <select id="appType" class="custom-select">
                                        <option value="social">Social Media</option>
                                        <option value="business">Business</option>
                                        <option value="portfolio">Portfolio</option>
                                        <option value="ecommerce">E-commerce</option>
                                        <option value="blog">Blog</option>
                                        <option value="dashboard">Dashboard</option>
                                        <option value="education">Education</option>
                                        <option value="health">Health & Fitness</option>
                                        <option value="weather">Weather</option>
                                    </select>
                                </div>
                            </div>
                            <div class="custom-input-row">
                                <div class="custom-input-group">
                                    <label class="custom-label">Primary Color</label>
                                    <div class="color-input-group">
                                        <input type="text" id="primaryColor" class="custom-input" placeholder="#7C3AED" value="#7C3AED">
                                        <input type="color" id="colorPicker" class="color-picker" value="#7C3AED">
                                    </div>
                                </div>
                                <div class="custom-input-group">
                                    <label class="custom-label">Layout Type</label>
                                    <select id="layoutType" class="custom-select">
                                        <option value="modern">Modern Layout</option>
                                        <option value="minimal">Minimal Layout</option>
                                        <option value="grid">Grid Layout</option>
                                        <option value="card">Card Layout</option>
                                        <option value="magazine">Magazine Layout</option>
                                    </select>
                                </div>
                            </div>
                            <div class="custom-input-row">
                                <div class="custom-input-group">
                                    <label class="custom-label">Theme</label>
                                    <select id="themeType" class="custom-select">
                                        <option value="light">Light Theme</option>
                                        <option value="dark">Dark Theme</option>
                                        <option value="gradient">Gradient Theme</option>
                                        <option value="professional">Professional</option>
                                    </select>
                                </div>
                                <div class="custom-input-group">
                                    <label class="custom-label">Framework</label>
                                    <select id="frameworkType" class="custom-select">
                                        <option value="vanilla">Vanilla HTML/CSS/JS</option>
                                        <option value="bootstrap">Bootstrap</option>
                                        <option value="tailwind">Tailwind CSS</option>
                                        <option value="material">Material Design</option>
                                    </select>
                                </div>
                            </div>
                            <div class="feature-toggle">
                                <div class="toggle-label">
                                    <span>üåô</span>
                                    <span>Dark Mode</span>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="darkModeToggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="feature-toggle">
                                <div class="toggle-label">
                                    <span>üì±</span>
                                    <span>Responsive Design</span>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="responsiveToggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="feature-toggle">
                                <div class="toggle-label">
                                    <span>‚ú®</span>
                                    <span>Animations</span>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="animationsToggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <div class="feature-toggle">
                                <div class="toggle-label">
                                    <span>üîç</span>
                                    <span>SEO Optimized</span>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="seoToggle" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                            <button class="action-btn credits" onclick="generateCustomApp()" style="width: 100%; margin-top: 1.5rem;">
                                <span>üöÄ</span>
                                <span>Generate Custom App (40‚ö°)</span>
                            </button>
                        </div>

                        <div class="chat-input-container">
                            <div class="chat-input">
                                <textarea 
                                    class="input-field" 
                                    id="messageInput" 
                                    placeholder="Describe your app idea or ask anything... (40‚ö° for apps, 5‚ö° for chat)"
                                    rows="3"
                                ></textarea>
                                <button class="send-btn" id="sendBtn" onclick="sendMessage()">
                                    <span>Send</span>
                                    <span>üöÄ</span>
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- Right Panel -->
                    <div class="right-panel">
                        <!-- Phone Preview -->
                        <section class="phone-preview">
                            <h3 style="margin-bottom: 1.5rem; text-align: center; color: var(--text-primary);">üì± Live Preview</h3>
                            <div class="phone-device">
                                <div class="phone-screen">
                                    <div class="app-preview" id="appPreview">
                                        <div class="generated-app" id="generatedApp">
                                            <div class="preview-header">
                                                <h4>Your App Preview</h4>
                                                <p>App content will appear here once generated</p>
                                            </div>
                                            <div class="preview-content">
                                                <div class="preview-placeholder"></div>
                                                <div class="preview-placeholder"></div>
                                                <div class="preview-placeholder"></div>
                                                <div class="preview-placeholder"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Progress Section -->
                            <div class="progress-container" id="progressSection">
                                <div class="progress-header">
                                    <h4>AI Building Your App...</h4>
                                    <span class="progress-text" id="progressText">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill"></div>
                                </div>
                            </div>

                            <!-- Scale Controls -->
                            <div class="scale-controls" id="scaleControls">
                                <button class="scale-btn active" onclick="setScale(1)">100%</button>
                                <button class="scale-btn" onclick="setScale(0.85)">85%</button>
                                <button class="scale-btn" onclick="setScale(0.7)">70%</button>
                                <button class="scale-btn" onclick="setScale(0.55)">55%</button>
                            </div>

                            <!-- Download Button -->
                            <button class="download-btn" id="downloadBtn" onclick="downloadApp()">
                                <span>üì•</span>
                                <span>Download App</span>
                            </button>
                        </section>

                        <!-- History Section -->
                        <section class="history-section">
                            <div class="history-header">
                                <h3>üìö Project History</h3>
                                <button class="action-btn secondary" onclick="clearHistory()">
                                    <span>Clear</span>
                                </button>
                            </div>
                            <div id="historyList">
                                <div class="history-item" onclick="loadExampleProject()">
                                    <h4>üì± Social Media Template</h4>
                                    <p>Modern social media app with dark theme</p>
                                    <div class="history-date">Example Project</div>
                                </div>
                                <p style="color: var(--text-secondary); text-align: center; margin-top: 1rem; font-size: 0.875rem;">
                                    Your generated projects will appear here
                                </p>
                            </div>
                        </section>
                    </div>
                </div>
            </div>

            <!-- Projects Section -->
            <div id="projectsSection" class="section">
                <div class="section-header">
                    <h1>Your Projects</h1>
                    <p>Manage and view all your generated applications</p>
                </div>
                <div class="projects-grid">
                    <div class="project-card" onclick="loadProject('social')">
                        <div class="project-icon">üì±</div>
                        <h3>Social Media App</h3>
                        <p>Modern social platform with posts, likes, and comments. Features dark theme and responsive design.</p>
                        <div class="project-stats">
                            <span>Generated: 2 days ago</span>
                            <span>40‚ö°</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="loadProject('weather')">
                        <div class="project-icon">üå§Ô∏è</div>
                        <h3>Weather Pro</h3>
                        <p>Beautiful weather application with animated icons, 7-day forecast, and city search functionality.</p>
                        <div class="project-stats">
                            <span>Generated: 1 week ago</span>
                            <span>40‚ö°</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="loadProject('recipe')">
                        <div class="project-icon">üç≥</div>
                        <h3>Recipe Collection</h3>
                        <p>Cooking app with categories, favorites, shopping list and detailed recipe instructions.</p>
                        <div class="project-stats">
                            <span>Generated: 3 days ago</span>
                            <span>40‚ö°</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="newProject()">
                        <div class="project-icon">‚ûï</div>
                        <h3>Create New Project</h3>
                        <p>Start building a new application with AI assistance. Choose from templates or create custom.</p>
                        <div class="project-stats">
                            <span>Ready to build</span>
                            <span>40‚ö°</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Documentation Section -->
            <div id="documentationSection" class="section">
                <div class="section-header">
                    <h1>Documentation</h1>
                    <p>Learn how to use PartexAI and build amazing applications</p>
                </div>
                <div class="docs-container">
                    <div class="docs-sidebar">
                        <ul class="docs-nav">
                            <li><a href="#getting-started" class="active" onclick="showDocsSection('getting-started')">Getting Started</a></li>
                            <li><a href="#templates" onclick="showDocsSection('templates')">Templates</a></li>
                            <li><a href="#customization" onclick="showDocsSection('customization')">Customization</a></li>
                            <li><a href="#credits" onclick="showDocsSection('credits')">Credits System</a></li>
                            <li><a href="#exporting" onclick="showDocsSection('exporting')">Exporting Apps</a></li>
                            <li><a href="#best-practices" onclick="showDocsSection('best-practices')">Best Practices</a></li>
                        </ul>
                    </div>
                    <div class="docs-content">
                        <div id="getting-started" class="docs-section active">
                            <h2>Getting Started with PartexAI</h2>
                            <p>Welcome to PartexAI! This guide will help you create your first application in minutes.</p>
                            
                            <h3>Creating Your First App</h3>
                            <p>To generate an application:</p>
                            <ol>
                                <li>Describe your app idea in the chat (e.g., "Create a weather app with dark theme")</li>
                                <li>Use templates for quick starts (Social Media, Weather, Recipe, etc.)</li>
                                <li>Customize using the advanced options for more control</li>
                                <li>Click generate and watch AI build your app</li>
                                <li>Download the HTML file when complete</li>
                            </ol>

                            <div class="code-block">
// Example app description<br>
"Create a modern weather app with animated icons, 7-day forecast, and city search functionality. Use dark theme with gradient backgrounds."
                            </div>
                        </div>

                        <div id="templates" class="docs-section">
                            <h2>Available Templates</h2>
                            <p>PartexAI offers several pre-built templates to get you started quickly:</p>
                            
                            <h3>üì± Social Media App</h3>
                            <p>Complete social platform with posts, comments, likes, and user profiles. Features responsive design and modern UI.</p>
                            
                            <h3>üå§Ô∏è Weather App</h3>
                            <p>Beautiful weather application with animated icons, forecasts, and location-based services.</p>
                            
                            <h3>üç≥ Recipe App</h3>
                            <p>Cooking companion with categories, favorites, shopping lists, and detailed instructions.</p>
                            
                            <h3>üì∞ News Reader</h3>
                            <p>Modern news aggregator with categories, bookmarks, and personalized feeds.</p>
                        </div>

                        <div id="customization" class="docs-section">
                            <h2>Customization Options</h2>
                            <p>Fine-tune your applications with extensive customization options:</p>
                            
                            <h3>Color Scheme</h3>
                            <p>Choose primary colors, gradients, and theme variations (light/dark).</p>
                            
                            <h3>Layout Types</h3>
                            <p>Select from modern, minimal, grid, card, or magazine layouts.</p>
                            
                            <h3>Framework Support</h3>
                            <p>Generate apps using Vanilla HTML/CSS, Bootstrap, Tailwind CSS, or Material Design.</p>
                            
                            <h3>Advanced Features</h3>
                            <p>Enable/disable responsive design, animations, SEO optimization, and more.</p>
                        </div>

                        <div id="credits" class="docs-section">
                            <h2>Credits System</h2>
                            <p>PartexAI uses a credit-based system for app generation:</p>
                            
                            <h3>Daily Allocation</h3>
                            <p>Every user receives 400 credits daily, resetting at midnight UTC.</p>
                            
                            <h3>Cost Structure</h3>
                            <ul>
                                <li><strong>App Generation:</strong> 40 credits per application</li>
                                <li><strong>Chat Questions:</strong> 5 credits per conversation</li>
                            </ul>
                            
                            <h3>Usage Tips</h3>
                            <p>With daily credits, you can create up to 10 applications per day. Plan your projects accordingly!</p>
                        </div>

                        <div id="exporting" class="docs-section">
                            <h2>Exporting Your Applications</h2>
                            <p>Once your app is generated, you can download and use it anywhere:</p>
                            
                            <h3>Download Process</h3>
                            <p>Click the download button to get a complete HTML file containing your application.</p>
                            
                            <h3>Hosting Options</h3>
                            <p>Your generated apps can be hosted on:</p>
                            <ul>
                                <li>GitHub Pages (free)</li>
                                <li>Netlify (free tier available)</li>
                                <li>Vercel (free tier available)</li>
                                <li>Any traditional web hosting service</li>
                            </ul>
                            
                            <h3>Customization After Export</h3>
                            <p>You can further customize the downloaded code using any code editor. The generated code is clean and well-structured.</p>
                        </div>

                        <div id="best-practices" class="docs-section">
                            <h2>Best Practices</h2>
                            <p>Follow these tips for the best results with PartexAI:</p>
                            
                            <h3>Writing Effective Prompts</h3>
                            <ul>
                                <li>Be specific about features and design preferences</li>
                                <li>Mention color schemes and layout preferences</li>
                                <li>Specify if you need mobile-responsive design</li>
                                <li>Include any special functionality requirements</li>
                            </ul>
                            
                            <h3>Example Prompts</h3>
                            <div class="code-block">
// Good prompt<br>
"Create a portfolio website with dark theme, project gallery, contact form, and smooth animations. Use modern layout with purple accent color."

// Better prompt<br>
"Build an e-commerce app with product catalog, shopping cart, user reviews, and search functionality. Use light theme with blue primary color and card-based layout."
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Templates Section -->
            <div id="templatesSection" class="section">
                <div class="section-header">
                    <h1>App Templates</h1>
                    <p>Choose from pre-built templates to start quickly</p>
                </div>
                <div class="projects-grid">
                    <div class="project-card" onclick="selectTemplate('social')">
                        <div class="project-icon">üì±</div>
                        <h3>Social Media</h3>
                        <p>Modern social platform with posts, comments, likes, and user profiles. Perfect for community apps.</p>
                        <div class="project-stats">
                            <span>40 credits</span>
                            <span>Instant generation</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="selectTemplate('weather')">
                        <div class="project-icon">üå§Ô∏è</div>
                        <h3>Weather App</h3>
                        <p>Beautiful weather application with forecasts, animations, and location services. Always up-to-date design.</p>
                        <div class="project-stats">
                            <span>40 credits</span>
                            <span>Instant generation</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="selectTemplate('recipe')">
                        <div class="project-icon">üç≥</div>
                        <h3>Recipe Collection</h3>
                        <p>Cooking companion with categories, favorites, and shopping lists. Perfect for food enthusiasts.</p>
                        <div class="project-stats">
                            <span>40 credits</span>
                            <span>Instant generation</span>
                        </div>
                    </div>
                    <div class="project-card" onclick="selectTemplate('news')">
                        <div class="project-icon">üì∞</div>
                        <h3>News Reader</h3>
                        <p>Modern news aggregator with categories, bookmarks, and personalized feeds. Clean reading experience.</p>
                        <div class="project-stats">
                            <span>40 credits</span>
                            <span>Instant generation</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Support Section -->
            <div id="supportSection" class="section">
                <div class="section-header">
                    <h1>Support</h1>
                    <p>Get help and support for PartexAI</p>
                </div>
                <div class="projects-grid">
                    <div class="project-card">
                        <div class="project-icon">üìö</div>
                        <h3>Documentation</h3>
                        <p>Comprehensive guides and tutorials for using PartexAI effectively.</p>
                    </div>
                    <div class="project-card">
                        <div class="project-icon">üí¨</div>
                        <h3>Community Forum</h3>
                        <p>Connect with other developers, share projects, and get inspiration.</p>
                    </div>
                    <div class="project-card">
                        <div class="project-icon">üêõ</div>
                        <h3>Report Issues</h3>
                        <p>Found a bug or having trouble? Let us know so we can fix it.</p>
                    </div>
                    <div class="project-card">
                        <div class="project-icon">üí°</div>
                        <h3>Feature Requests</h3>
                        <p>Suggest new features and improvements for PartexAI.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // =============================================
        // FIREBASE CONFIGURATION & INITIALIZATION
        // =============================================
        const firebaseConfig = {
            apiKey: "AIzaSyCC3sXBJl3ej2lgUBbi2vh_YjJc-P9q2xQ",
            authDomain: "partexai.firebaseapp.com",
            databaseURL: "https://partexai-default-rtdb.firebaseio.com",
            projectId: "partexai",
            storageBucket: "partexai.firebasestorage.app",
            messagingSenderId: "539986724179",
            appId: "1:539986724179:web:3f0bfc9cb124305d4b8da6"
        };

        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            console.log("üî• Firebase initialized successfully");
        } catch (error) {
            console.log("‚ÑπÔ∏è Firebase already initialized");
        }
        
        const auth = firebase.auth();
        const database = firebase.database();

        // =============================================
        // APP CONSTANTS & CONFIGURATION
        // =============================================
        const APP_COST = 40;
        const CHAT_COST = 5;
        const DAILY_CREDITS = 400;
        
        // =============================================
        // GLOBAL STATE MANAGEMENT
        // =============================================
        let userCredits = 400;
        let currentUser = null;
        let userHistory = [];
        let currentGeneratedApp = null;
        let currentScale = 1;
        let isProcessing = false;

        // =============================================
        // AUTHENTICATION SYSTEM
        // =============================================
        function showRegister() {
            document.getElementById('loginDiv').style.display = 'none';
            document.getElementById('registerDiv').style.display = 'block';
            document.getElementById('registerError').style.display = 'none';
        }

        function showLogin() {
            document.getElementById('registerDiv').style.display = 'none';
            document.getElementById('loginDiv').style.display = 'block';
            document.getElementById('loginError').style.display = 'none';
        }

        function showError(type, message) {
            const errorDiv = document.getElementById(type + 'Error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        async function register() {
            const username = document.getElementById('registerUsername').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const password = document.getElementById('registerPassword').value;
            
            if (!username || !email || !password) {
                showError('register', '‚ùå Please fill in all fields');
                return;
            }

            if (password.length < 6) {
                showError('register', '‚ùå Password must be at least 6 characters long');
                return;
            }

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                
                // Save user data to database
                await database.ref('users/' + user.uid).set({
                    username: username,
                    email: email,
                    credits: DAILY_CREDITS,
                    createdAt: new Date().toISOString(),
                    lastReset: new Date().toDateString(),
                    history: [],
                    preferences: {
                        theme: 'dark',
                        notifications: true
                    }
                });

                console.log('‚úÖ User registered successfully:', user);
                showError('register', '‚úÖ Account created successfully! Redirecting...');
                
                setTimeout(() => {
                    document.getElementById('authContainer').style.display = 'none';
                    document.getElementById('appContainer').style.display = 'block';
                }, 1500);
                
            } catch (error) {
                console.error('‚ùå Registration error:', error);
                let errorMessage = 'Registration failed: ';
                
                switch (error.code) {
                    case 'auth/email-already-in-use':
                        errorMessage += 'Email is already registered';
                        break;
                    case 'auth/invalid-email':
                        errorMessage += 'Invalid email address';
                        break;
                    case 'auth/weak-password':
                        errorMessage += 'Password is too weak';
                        break;
                    default:
                        errorMessage += error.message;
                }
                
                showError('register', errorMessage);
            }
        }

        async function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showError('login', '‚ùå Please enter both email and password');
                return;
            }

            try {
                await auth.signInWithEmailAndPassword(email, password);
            } catch (error) {
                console.error('‚ùå Login error:', error);
                let errorMessage = 'Login failed: ';
                
                switch (error.code) {
                    case 'auth/user-not-found':
                        errorMessage += 'No account found with this email';
                        break;
                    case 'auth/wrong-password':
                        errorMessage += 'Incorrect password';
                        break;
                    case 'auth/invalid-email':
                        errorMessage += 'Invalid email address';
                        break;
                    default:
                        errorMessage += error.message;
                }
                
                showError('login', errorMessage);
            }
        }

        function logout() {
            auth.signOut();
        }

        // Auth state listener
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                currentUser = user;
                document.getElementById('userAvatar').textContent = user.email.charAt(0).toUpperCase();
                await loadUserData();
                document.getElementById('authContainer').style.display = 'none';
                document.getElementById('appContainer').style.display = 'block';
                console.log('‚úÖ User signed in:', user.email);
            } else {
                currentUser = null;
                document.getElementById('authContainer').style.display = 'flex';
                document.getElementById('appContainer').style.display = 'none';
                console.log('‚úÖ User signed out');
            }
        });

        // =============================================
        // USER DATA MANAGEMENT
        // =============================================
        async function loadUserData() {
            if (!currentUser) return;
            
            try {
                const userRef = database.ref('users/' + currentUser.uid);
                const snapshot = await userRef.once('value');
                const userData = snapshot.val();
                
                if (userData) {
                    // Check daily credit reset
                    const today = new Date().toDateString();
                    if (userData.lastReset !== today) {
                        userCredits = DAILY_CREDITS;
                        await userRef.update({
                            credits: DAILY_CREDITS,
                            lastReset: today
                        });
                    } else {
                        userCredits = userData.credits || DAILY_CREDITS;
                    }
                    
                    // Load history
                    userHistory = userData.history || [];
                    updateHistoryDisplay();
                    updateCreditsDisplay();
                }
            } catch (error) {
                console.error('‚ùå Error loading user data:', error);
            }
        }

        async function updateCredits(change) {
            if (!currentUser) return;
            
            userCredits += change;
            try {
                await database.ref('users/' + currentUser.uid).update({
                    credits: userCredits
                });
                updateCreditsDisplay();
            } catch (error) {
                console.error('‚ùå Error updating credits:', error);
            }
        }

        function updateCreditsDisplay() {
            const creditsElement = document.getElementById('creditsCount');
            creditsElement.textContent = userCredits;
            
            // Add animation when credits change
            creditsElement.style.transform = 'scale(1.1)';
            setTimeout(() => {
                creditsElement.style.transform = 'scale(1)';
            }, 300);
        }

        // =============================================
        // NAVIGATION SYSTEM
        // =============================================
        function showSection(section) {
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show section content
            const sections = ['dashboard', 'projects', 'templates', 'documentation', 'support'];
            sections.forEach(sec => {
                const element = document.getElementById(sec + 'Section');
                if (element) {
                    element.classList.remove('active');
                }
            });
            
            const targetSection = document.getElementById(section + 'Section');
            if (targetSection) {
                targetSection.classList.add('active');
            }
        }

        function showDocsSection(section) {
            // Update active docs nav
            document.querySelectorAll('.docs-nav a').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show docs content
            const sections = ['getting-started', 'templates', 'customization', 'credits', 'exporting', 'best-practices'];
            sections.forEach(sec => {
                const element = document.getElementById(sec);
                if (element) {
                    element.classList.remove('active');
                }
            });
            
            const targetSection = document.getElementById(section);
            if (targetSection) {
                targetSection.classList.add('active');
            }
        }

        // =============================================
        // PROJECTS MANAGEMENT
        // =============================================
        function loadProject(type) {
            showSection('dashboard');
            setTimeout(() => {
                selectTemplate(type);
            }, 100);
        }

        function newProject() {
            showSection('dashboard');
            setTimeout(() => {
                showCustomInput();
            }, 100);
        }

        // =============================================
        // APP GENERATION SYSTEM - COMPLETELY FIXED
        // =============================================
        function selectTemplate(templateType) {
            if (userCredits < APP_COST) {
                showInsufficientCredits();
                return;
            }

            const templates = {
                'social': 'Create a modern social media app with posts, comments, likes, and user profiles. Use dark theme with purple accent color and responsive design.',
                'recipe': 'Create a recipe app with categories, favorites, shopping list and search function. Include nutritional information and cooking instructions.',
                'news': 'Create a news reader with personalized feeds, categories, bookmarks and offline functionality. Use clean modern design.',
                'weather': 'Create a modern weather app with animated icons, 7-day forecast, city search, and real-time weather data display. Use gradient backgrounds and dark theme.'
            };
            
            document.getElementById('messageInput').value = templates[templateType];
            addMessage(templates[templateType], 'user');
            processAppGeneration(templates[templateType]);
        }

        function generateCustomApp() {
            if (userCredits < APP_COST) {
                showInsufficientCredits();
                return;
            }

            const appName = document.getElementById('appName').value;
            const appType = document.getElementById('appType').value;
            const primaryColor = document.getElementById('primaryColor').value;
            const layoutType = document.getElementById('layoutType').value;
            const themeType = document.getElementById('themeType').value;
            const frameworkType = document.getElementById('frameworkType').value;
            const darkMode = document.getElementById('darkModeToggle').checked;
            const responsive = document.getElementById('responsiveToggle').checked;
            const animations = document.getElementById('animationsToggle').checked;
            const seo = document.getElementById('seoToggle').checked;

            const customDescription = `Create a ${appType} app named "${appName}" with ${layoutType} layout, ${themeType} theme, ${frameworkType} framework, primary color ${primaryColor}. Features: ${darkMode ? 'dark mode' : 'light mode'}, ${responsive ? 'responsive design' : 'fixed layout'}, ${animations ? 'with animations' : 'no animations'}, ${seo ? 'SEO optimized' : 'basic SEO'}.`;

            document.getElementById('messageInput').value = customDescription;
            addMessage(customDescription, 'user');
            processAppGeneration(customDescription);
            
            document.getElementById('customInputSection').style.display = 'none';
        }

        async function processAppGeneration(description) {
            if (isProcessing) {
                addMessage("‚è≥ Please wait for the current request to complete...", 'ai');
                return;
            }

            isProcessing = true;
            const sendBtn = document.getElementById('sendBtn');
            sendBtn.disabled = true;
            sendBtn.innerHTML = '<span>Creating...</span><span>‚ö°</span>';

            // Deduct credits
            await updateCredits(-APP_COST);

            // Show progress
            showProgress();

            try {
                // Simulate AI processing with progress updates
                await simulateAIProcessing(description);
                
                // Generate the actual app
                const generatedApp = generateAppFromDescription(description);
                displayGeneratedApp(generatedApp);
                
                // Save to history
                await addToHistory(description, generatedApp, true);
                
                // Show success message
                addMessage(`üéâ Your app has been successfully generated! You can now see it in the live preview and download the HTML file. (${APP_COST} credits used)`, 'ai');
                
                // Show download options
                document.getElementById('downloadBtn').style.display = 'flex';
                document.getElementById('scaleControls').style.display = 'flex';
                
            } catch (error) {
                console.error('‚ùå App generation error:', error);
                addMessage('‚ùå Sorry, there was an error generating your app. Your credits have been refunded.', 'ai');
                // Refund credits
                await updateCredits(APP_COST);
            } finally {
                isProcessing = false;
                sendBtn.disabled = false;
                sendBtn.innerHTML = '<span>Send</span><span>üöÄ</span>';
                hideProgress();
            }
        }

        function generateAppFromDescription(description) {
            const appName = extractAppName(description);
            const appType = detectAppType(description);
            const isDark = description.toLowerCase().includes('dark');
            const primaryColor = extractColor(description) || '#7C3AED';

            if (appType === 'weather') {
                return generateWeatherApp(appName, primaryColor, isDark);
            } else if (appType === 'social') {
                return generateSocialMediaApp(appName, primaryColor, isDark);
            } else {
                return generateDefaultApp(appName, primaryColor, isDark);
            }
        }

        // =============================================
        // APP TEMPLATES
        // =============================================
        function generateWeatherApp(name, primaryColor, isDark) {
            const bgColor = isDark ? '#0f172a' : '#f0f9ff';
            const textColor = isDark ? '#f8fafc' : '#0f172a';
            
            return `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${name} - Weather</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 2rem 1rem;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .search-bar {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 1rem 1.5rem;
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .search-input {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            font-size: 1rem;
            outline: none;
        }
        
        .search-btn {
            background: ${primaryColor};
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
        }
        
        .current-weather {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .temperature {
            font-size: 4rem;
            font-weight: 300;
            margin: 1rem 0;
        }
        
        .description {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .forecast {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
        }
        
        .forecast-day {
            background: rgba(255,255,255,0.1);
            padding: 1rem;
            border-radius: 15px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>${name}</h1>
            <p>Real-time Weather Forecast</p>
        </div>
        
        <div class="search-bar">
            <input type="text" class="search-input" placeholder="Search city...">
            <button class="search-btn">Search</button>
        </div>
        
        <div class="current-weather">
            <div class="temperature">22¬∞C</div>
            <div class="description">Partly Cloudy</div>
            <div>Berlin, Germany</div>
        </div>
        
        <div class="forecast">
            <div class="forecast-day">
                <div>Mon</div>
                <div>‚òÄÔ∏è</div>
                <div>24¬∞</div>
            </div>
            <div class="forecast-day">
                <div>Tue</div>
                <div>üå§Ô∏è</div>
                <div>23¬∞</div>
            </div>
            <div class="forecast-day">
                <div>Wed</div>
                <div>üåßÔ∏è</div>
                <div>19¬∞</div>
            </div>
        </div>
    </div>
</body>
</html>`;
        }

        function generateSocialMediaApp(name, primaryColor, isDark) {
            const bgColor = isDark ? '#0f0f0f' : '#ffffff';
            const textColor = isDark ? '#ffffff' : '#0f0f0f';
            
            return `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${name}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: ${bgColor};
            color: ${textColor};
        }
        
        .navbar {
            background: ${primaryColor};
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
        }
        
        .container {
            max-width: 600px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .post {
            background: ${isDark ? '#1a1a1a' : '#f8f9fa'};
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="logo">${name}</div>
        <div class="nav-icons">
            <span>üè†</span>
            <span>üîç</span>
        </div>
    </nav>
    
    <div class="container">
        <div class="post">
            <h3>Welcome to ${name}!</h3>
            <p>Connect with friends and share your moments.</p>
        </div>
    </div>
</body>
</html>`;
        }

        function generateDefaultApp(name, primaryColor, isDark) {
            return `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${name}</title>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 2rem;
            background: ${isDark ? '#0f0f0f' : '#ffffff'};
            color: ${isDark ? '#ffffff' : '#0f0f0f'};
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        
        h1 {
            color: ${primaryColor};
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>${name}</h1>
        <p>Your app generated by PartexAI</p>
    </div>
</body>
</html>`;
        }

        // =============================================
        // UTILITY FUNCTIONS
        // =============================================
        function extractAppName(description) {
            const match = description.match(/"([^"]+)"/);
            return match ? match[1] : 'My Awesome App';
        }

        function extractColor(description) {
            const colorMatch = description.match(/#([a-f0-9]{6}|[a-f0-9]{3})/i);
            return colorMatch ? colorMatch[0] : null;
        }

        function detectAppType(description) {
            const lowerDesc = description.toLowerCase();
            if (lowerDesc.includes('social')) return 'social';
            if (lowerDesc.includes('weather')) return 'weather';
            if (lowerDesc.includes('recipe')) return 'recipe';
            if (lowerDesc.includes('news')) return 'news';
            return 'default';
        }

        // =============================================
        // UI INTERACTION FUNCTIONS
        // =============================================
        function showCustomInput() {
            const section = document.getElementById('customInputSection');
            section.style.display = section.style.display === 'none' ? 'block' : 'none';
        }

        function showInsufficientCredits() {
            addMessage(`‚ùå Insufficient credits! You need ${APP_COST} credits to generate an app. You have ${userCredits} credits.`, 'ai');
        }

        function addMessage(text, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${sender === 'user' ? 'U' : 'AI'}</div>
                <div class="message-content">
                    <p class="message-text">${text.replace(/\n/g, '<br>')}</p>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;

            // Add user message
            addMessage(message, 'user');
            input.value = '';

            // Simple chat response
            setTimeout(() => {
                addMessage("I understand you're asking about: " + message + ". For app generation, please use the template buttons or custom app generator.", 'ai');
            }, 1000);
        }

        // =============================================
        // PROGRESS & PREVIEW SYSTEM
        // =============================================
        async function simulateAIProcessing(message) {
            const steps = [
                { progress: 20, text: "üìã Analyzing your requirements..." },
                { progress: 40, text: "üé® Designing user interface..." },
                { progress: 60, text: "‚ö° Implementing features..." },
                { progress: 80, text: "üîß Finalizing app structure..." },
                { progress: 100, text: "‚úÖ App successfully generated!" }
            ];

            for (let i = 0; i < steps.length; i++) {
                const step = steps[i];
                updateProgress(step.progress);
                addMessage(step.text, 'ai');
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
        }

        function updateProgress(percent) {
            document.getElementById('progressSection').style.display = 'block';
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressText').textContent = percent + '%';
        }

        function showProgress() {
            document.getElementById('progressSection').style.display = 'block';
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressText').textContent = '0%';
        }

        function hideProgress() {
            setTimeout(() => {
                document.getElementById('progressSection').style.display = 'none';
            }, 1000);
        }

        function displayGeneratedApp(appHtml) {
            const preview = document.getElementById('generatedApp');
            preview.innerHTML = appHtml;
            currentGeneratedApp = appHtml;
            setScale(currentScale);
        }

        function setScale(scale) {
            currentScale = scale;
            const generatedApp = document.getElementById('generatedApp');
            if (generatedApp) {
                generatedApp.style.transform = `scale(${scale})`;
                generatedApp.style.transformOrigin = 'top left';
                generatedApp.style.width = `${100/scale}%`;
                generatedApp.style.height = `${100/scale}%`;
            }
            
            // Update active button
            document.querySelectorAll('.scale-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function downloadApp() {
            if (!currentGeneratedApp) return;
            
            const blob = new Blob([currentGeneratedApp], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'my-app.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            addMessage("üì• App downloaded successfully!", 'ai');
        }

        // =============================================
        // HISTORY MANAGEMENT
        // =============================================
        async function addToHistory(description, code, isApp = true) {
            if (!currentUser) return;
            
            const historyItem = {
                id: Date.now(),
                description: description,
                code: code,
                date: new Date().toISOString(),
                isApp: isApp,
                creditsUsed: isApp ? APP_COST : CHAT_COST
            };
            
            userHistory.unshift(historyItem);
            
            if (userHistory.length > 10) {
                userHistory = userHistory.slice(0, 10);
            }
            
            try {
                await database.ref('users/' + currentUser.uid).update({
                    history: userHistory
                });
                updateHistoryDisplay();
            } catch (error) {
                console.error('‚ùå Error saving history:', error);
            }
        }

        function updateHistoryDisplay() {
            const historyList = document.getElementById('historyList');
            // History display implementation
        }

        function loadExampleProject() {
            showSection('dashboard');
            setTimeout(() => {
                selectTemplate('social');
            }, 100);
        }

        async function clearHistory() {
            if (!currentUser) return;
            
            userHistory = [];
            try {
                await database.ref('users/' + currentUser.uid).update({
                    history: []
                });
                updateHistoryDisplay();
                addMessage("üóëÔ∏è History cleared successfully.", 'ai');
            } catch (error) {
                console.error('‚ùå Error clearing history:', error);
            }
        }

        // =============================================
        // INITIALIZATION
        // =============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize color picker
            const colorPicker = document.getElementById('colorPicker');
            const colorInput = document.getElementById('primaryColor');
            
            colorPicker.addEventListener('input', function(e) {
                colorInput.value = e.target.value;
            });

            colorInput.addEventListener('input', function(e) {
                if (e.target.value.match(/^#[0-9A-F]{6}$/i)) {
                    colorPicker.value = e.target.value;
                }
            });

            // Enter key for message input
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Auto-resize textarea
            document.getElementById('messageInput').addEventListener('input', function(e) {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 120) + 'px';
            });

            // Demo mode
            setTimeout(() => {
                if (!currentUser) {
                    document.getElementById('authContainer').style.display = 'none';
                    document.getElementById('appContainer').style.display = 'block';
                    updateCreditsDisplay();
                    console.log('üöÄ PartexAI loaded in demo mode');
                }
            }, 1000);

            console.log('üéâ PartexAI initialized successfully!');
        });
    </script>
</body>
</html>
